        // =============================================
        // GUIDED QUESTIONS
        // =============================================

        const questionsByCategory = {
            deductions: [
                { id: 'excessive-deductions', text: 'Are my operators charging excessive deductions?', badge: null, badgeClass: '' },
                { id: 'county-comparison', text: 'How do my deductions compare to county averages?', badge: null, badgeClass: '' },
                { id: 'deduction-trend', text: 'Are deductions increasing over time on any wells?', badge: null, badgeClass: '' },
                { id: 'effective-royalty', text: 'What is my effective royalty rate after deductions?', badge: null, badgeClass: '' }
            ],
            performance: [
                { id: 'underperforming', text: 'Which of my wells are underperforming?', badge: null, badgeClass: '' },
                { id: 'shut-in', text: 'Are any wells shut-in that shouldn\'t be?', badge: null, badgeClass: '' },
                { id: 'nearby-comparison', text: 'How does my production compare to nearby wells?', badge: null, badgeClass: '' },
                { id: 'price-realization', text: 'Am I getting fair market price for my production?', badge: null, badgeClass: '' }
            ],
            lease: [
                { id: 'lease-comps', text: 'Am I getting fair lease terms compared to my area?', badge: null, badgeClass: '' },
                { id: 'next-check', text: 'What should my next royalty check be?', badge: null, badgeClass: '' },
                { id: 'lease-expiration', text: 'Which leases are approaching expiration?', badge: null, badgeClass: '' },
                { id: 'check-vs-otc', text: 'Does my check stub match what OTC reports?', badge: null, badgeClass: '' }
            ],
            risk: [
                { id: 'pending-deadlines', text: 'Do I have any pending deadlines?', badge: null, badgeClass: '' },
                { id: 'operator-concern', text: 'Which operators should I be concerned about?', badge: null, badgeClass: '' },
                { id: 'nearby-permits', text: 'Are there permits near me I should know about?', badge: null, badgeClass: '' },
                { id: 'revenue-continuity', text: 'Am I being paid on all producing wells?', badge: null, badgeClass: '' }
            ]
        };

        const chevronSvg = '<svg class="chevron-icon" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round"/></svg>';

        function setupCategoryTabs() {
            const tabs = document.querySelectorAll('.category-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    renderQuestions(tab.dataset.category);
                });
            });
        }

        function renderQuestions(category) {
            const grid = document.getElementById('questionsGrid');
            const questions = questionsByCategory[category] || [];

            grid.innerHTML = questions.map(q => {
                const badgeHtml = q.badge
                    ? `<span class="question-badge ${q.badgeClass}">${escapeHtml(q.badge)}</span>`
                    : '';

                return `
                    <div class="question-card" onclick="handleQuestionClick('${q.id}')">
                        <div class="question-text">${escapeHtml(q.text)}</div>
                        ${badgeHtml}
                        <span class="question-arrow">${chevronSvg}</span>
                    </div>
                `;
            }).join('');
        }

        function handleQuestionClick(questionId) {
            if (questionId === 'excessive-deductions') {
                loadDeductionReport();
                return;
            }
            console.log('Question clicked:', questionId);
            showToast('Report generation coming soon', 'info');
        }

        // Update question badges based on summary data
        function updateQuestionBadges(summaryData) {
            if (!summaryData) return;

            // Deduction flags
            if (summaryData.deductionFlags > 0) {
                const q = questionsByCategory.deductions.find(q => q.id === 'excessive-deductions');
                if (q) {
                    q.badge = `${summaryData.deductionFlags} Flags`;
                    q.badgeClass = 'badge-alert';
                }
            }

            // Shut-in wells
            if (summaryData.shutInWells > 0) {
                const q = questionsByCategory.performance.find(q => q.id === 'shut-in');
                if (q) {
                    q.badge = `${summaryData.shutInWells} Wells`;
                    q.badgeClass = 'badge-alert';
                }
            }

            // Action items / deadlines
            if (summaryData.actionItems > 0) {
                const q = questionsByCategory.risk.find(q => q.id === 'pending-deadlines');
                if (q) {
                    q.badge = `${summaryData.actionItems} Pending`;
                    q.badgeClass = 'badge-alert';
                }
            }

            // Re-render current tab to show updated badges
            const activeTab = document.querySelector('.category-tab.active');
            if (activeTab) {
                renderQuestions(activeTab.dataset.category);
            }
        }

        // Custom question handler
        document.getElementById('customQuestionBtn').addEventListener('click', () => {
            const input = document.getElementById('customQuestionInput');
            const question = input.value.trim();
            if (!question) return;
            console.log('Custom question:', question);
            showToast('Custom questions coming in a future update', 'info');
            input.value = '';
        });

        document.getElementById('customQuestionInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('customQuestionBtn').click();
            }
        });
